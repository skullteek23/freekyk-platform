<mat-toolbar class="white-bg" [disabled]="menuState" appStickyNav panelClass="sticky-header">
  <div class="container" ngClass.lt-md="nogap" fxLayoutAlign="space-between center">
    <!-- brand logo -->
    <a class="logo" (click)="onCloseMenu(); scrollTop()" [routerLink]="['/']" fxLayoutAlign="center center">
      <img src="assets/images/brand_logo_2.png" alt="Freekyk Logo" />
    </a>
    <!-- brand logo -->
    <ng-container *ngIf="!isOnboarding">
      <!-- mobile menu on logged -->
      <div fxHide.gt-sm="true" fxLayoutAlign="center center" fxLayoutGap="4px">
        <div *ngIf="isLoading && !isLogged" fxLayoutAlign="center center" fxLayoutGap="8px">
          <span class="circles shine"></span>
          <span class="circles shine"></span>
          <span class="circles shine"></span>
        </div>

        <!-- whatsApp icon - small -->
        <!-- <button matTooltip="Join Us" *ngIf="!isLoading" mat-icon-button color="primary"
          (click)="openSocialGroupDialog();onCloseMenu()">
          <img src="assets/svgs/whatsapp_bw.svg" alt="WhatsApp Icon" class="whatsapp-icon">
        </button> -->
        <!-- whatsApp icon - small -->

        <!-- notif icon - small -->
        <button matTooltip="Notifications" *ngIf="isLogged && !isLoading" mat-icon-button color="primary"
          (click)="onCloseMenu()" [routerLink]="['/notifications']">
          <mat-icon [matBadge]="notificationCount$ | async" matBadgeSize="small"
            [matBadgeColor]="(notificationCount$ | async) == 0 ? 'primary' : 'accent'" class="material-icons-round">
            notifications
          </mat-icon>
        </button>
        <!-- notif icon - small -->

        <!-- cart icon - small -->
        <!-- <button disabled matTooltip="Cart" *ngIf="isLogged && !isLoading" mat-icon-button color="primary"
      (click)="onCloseMenu()" [routerLink]="['/cart']">
      <mat-icon class="material-icons-round"> shopping_cart </mat-icon>
    </button> -->
        <!-- cart icon - small -->

        <!-- account circle - small -->
        <!-- <div class="account-circle-container" *ngIf="isLogged && !isLoading" (click)="onCloseMenu()"
          [routerLink]="['/account']">
          <app-account-avatar [dataImg]="photoUrl" [margins]="false"></app-account-avatar>
        </div> -->
        <!-- account circle - small -->

        <!-- confetti icon - small -->
        <mat-chip-list *ngIf="!isLoading && isLogged">
          <mat-chip selected fxLayoutAlign="center center" fxLayoutGap="4px" (click)="getStartedReward()">
            <span class="mat-body-1 points-count">{{userPoints}}</span>
            <div class="coin-container">
              <span class="material-icons-round">
                payments
              </span>
            </div>
          </mat-chip>
        </mat-chip-list>
        <button *ngIf="!isLoading && !isLogged" mat-icon-button (click)="getStartedReward()">
          <span class="material-icons-round filled">
            celebration
          </span>
        </button>
        <!-- confetti icon - small -->

        <!-- ham menu - small -->
        <button mat-icon-button color="primary" (click)="onToggleMenu()">
          <mat-icon *ngIf="!menuState; else close" class="material-icons-round">
            menu
          </mat-icon>
          <ng-template #close>
            <mat-icon class="material-icons-round"> close </mat-icon>
          </ng-template>
        </button>
        <!-- ham menu - small -->
      </div>
      <!-- mobile menu on logged -->

      <!-- menu - large -->
      <div fxHide.lt-md="true" fxLayout fxLayoutGap="20px" fxLayoutAlign="center center">
        <a [matMenuTriggerFor]="playMenu" fxLayoutAlign="center center">
          <span class="mat-body-1">Play</span>
        </a>
        <a fxLayoutAlign="center center" routerLink="/support">
          <span class="mat-body-1">Support</span>
        </a>
        <a fxLayoutAlign="center center" [href]="adminURL" target="_blank">
          <span class="mat-body-1">Admin</span>
        </a>
        <!-- <a [matMenuTriggerFor]="freestyleMenu" fxLayoutAlign="center center">
      <span class="mat-body-1">Freestyle</span>
    </a>
    <a [routerLink]="['/academies']" fxLayoutAlign="center center">
      <span class="mat-body-1">Academies</span>
    </a>
    <a [routerLink]="['/equipment']" fxLayoutAlign="center center">
      <span class="mat-body-1">Equipment</span>
    </a> -->
        <a [matMenuTriggerFor]="moreMenu" fxLayoutAlign="center center">
          <span class="mat-body-1">More</span>
        </a>

        <mat-divider style="height: 30px" [vertical]="true"></mat-divider>

        <!-- Live Seasons icon -->
        <!-- <button class="live-season" fxHide.lt-md="true" matTooltip="Upcoming Seasons" mat-icon-button color="primary"
          [matMenuTriggerFor]="seasonMenu">
          <span class="material-icons-round red">sensors</span>
        </button> -->
        <!-- Live Seasons icon -->

        <!-- <button fxHide.lt-md="true" *ngIf="!isLogged && !isLoading" [routerLink]="['/login']"
      class="buttonText secondaryButton">
      Login
    </button> -->

        <button fxHide.lt-md="true" *ngIf="!isLogged && !isLoading" [routerLink]="['/signup']"
          class="buttonText primaryButton">
          Get Started
        </button>

        <div *ngIf="isLoading && !isLogged" fxHide.lt-md="true" fxLayoutAlign="center center" fxLayoutGap="8px">
          <span class="circles shine"></span>
          <span class="circles shine"></span>
          <span class="circles shine"></span>
          <span class="circles shine"></span>
        </div>


        <div fxHide.lt-md="true" fxLayoutAlign="center center" fxLayoutGap="8px">
          <!-- <button matTooltip="Join Us" *ngIf="isLogged && !isLoading" mat-icon-button color="primary"
            (click)="openSocialGroupDialog()">
            <img src="assets/svgs/whatsapp_bw.svg" alt="WhatsApp Icon" class="whatsapp-icon">
          </button> -->

          <button matTooltip="Notifications" *ngIf="isLogged && !isLoading" mat-icon-button color="primary"
            [routerLink]="['/notifications']">
            <mat-icon [matBadge]="notificationCount$ | async" matBadgeSize="small"
              [matBadgeColor]="(notificationCount$ | async) == 0 ? 'primary' : 'accent'" class="material-icons-round">
              notifications
            </mat-icon>
          </button>

          <!-- <button matTooltip="Cart" disabled *ngIf="isLogged && !isLoading" mat-icon-button color="primary"
        [routerLink]="['/cart']">
        <mat-icon *ngIf="!isLoading" class="material-icons-round">shopping_cart</mat-icon>
      </button> -->

          <!-- <app-account-avatar matTooltip="User Settings" *ngIf="isLogged && !isLoading"
            [matMenuTriggerFor]="profileMenu" [dataImg]="photoUrl" [margins]="false"></app-account-avatar> -->

        </div>

        <mat-menu #playMenu>
          <a mat-menu-item (click)="openLink(link)" *ngFor="let link of playLinks">
            <span class="mat-body-1">{{ link.name }}</span>
          </a>
        </mat-menu>

        <!-- <mat-menu #freestyleMenu>
      <a mat-menu-item (click)="openLink(link)" *ngFor="let link of freestyleLinks">
        <span class="mat-body-1">{{ link.name }}</span>
      </a>
    </mat-menu> -->

        <mat-menu #moreMenu>
          <a mat-menu-item (click)="openLink(link)" *ngFor="let link of moreDesktopLinks">
            <span class="mat-body-1">{{ link.name }}</span>
          </a>
        </mat-menu>

        <mat-menu #profileMenu>
          <a mat-menu-item (click)="openLink(link)" *ngFor="let link of profileAvatarLinks">
            <span class="mat-body-1">{{ link.name }}</span>
          </a>
        </mat-menu>

        <!-- <mat-menu #seasonMenu>
          <span class="mat-body-2 align">Upcoming Seasons</span>
          <a *ngFor="let season of seasonsList" mat-menu-item (click)="openLiveSeason(season)">
            <span class="mat-body-1">{{ season.name }}</span>
          </a>
        </mat-menu> -->
      </div>
      <!-- menu - large -->
    </ng-container>
  </div>
</mat-toolbar>


<!-- Mobile Expanded view -->
<div class="full-header" *ngIf="menuState" fxLayout="column" fxLayoutGap="20px">
  <div fxLayout="column" fxLayoutGap="8px" *ngIf="!isLogged">
    <!-- <button *ngIf="!isLogged" (click)="onToggleMenu()" [routerLink]="['/login']" class="buttonText secondaryButton">
      Login
    </button> -->
    <!-- <button *ngIf="isLogged" (click)="onToggleMenu()" [routerLink]="['/']"
      class="buttonText secondaryButton">
      Go to Dashboard
    </button> -->
    <button (click)="onToggleMenu()" [routerLink]="['/signup']" class="buttonText primaryButton">
      Get Started
    </button>
  </div>

  <mat-divider></mat-divider>

  <div class="profile-container" *ngIf="isLogged" fxLayout="row" fxLayoutGap="8px" fxLayoutAlign="start center">
    <div class="account-circle-container" (click)="onCloseMenu()" [routerLink]="['/edit-profile']">
      <app-account-avatar [dataImg]="user.photoURL" [margins]="false"></app-account-avatar>
    </div>
    <div class="text-container" fxLayout="column" fxLayoutAlign="center start" fxLayoutGap="4px">
      <span class="mat-body-1">
        {{user.displayName}}
      </span>
      <div fxLayoutAlign="start center" fxLayoutGap="4px">
        <span class="mat-caption">
          {{user.phoneNumber}}
        </span>
        <span class="material-icons-round filled verified-icon">
          check_circle
        </span>
        <span class="mat-caption">
          Verified
        </span>
      </div>
    </div>
  </div>

  <mat-divider></mat-divider>

  <div class="links-container" fxLayout="column" fxLayoutGap="4px">
    <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="example-tree">
      <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
        <li class="mat-tree-node">
          <div class="custom-button-container">
            <button class="link-button" fxFlex="100%" (click)="openLink(node);treeControl.collapseAll()"
              mat-stroked-button [color]="node.isLogout ? 'warn' : 'primary'">
              <span class="material-icons-round external-icon" *ngIf="node.icon">{{node.icon}}</span>
              {{node.name}}
            </button>
          </div>
        </li>
      </mat-tree-node>
      <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
        <li>
          <div class="mat-tree-node" matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.name">
            {{node.name}}
            <span class="mat-icon-rtl-mirror material-icons-round">
              {{treeControl.isExpanded(node) ? 'expand_less' : 'expand_more'}}
            </span>
          </div>
          <ul class="example-tree-ul" [class.example-tree-invisible]="!treeControl.isExpanded(node)">
            <ng-container matTreeNodeOutlet></ng-container>
          </ul>
        </li>
      </mat-nested-tree-node>

    </mat-tree>
    <div class="custom-button-container">
      <button class="link-button" fxFlex="100%" (click)="openMatchRequestForm()" mat-stroked-button color="primary">
        <span class="material-icons-round external-icon">sports_soccer</span>
        Request a Football Match!
      </button>
    </div>
  </div>
</div>
<!-- Mobile Expanded view -->
