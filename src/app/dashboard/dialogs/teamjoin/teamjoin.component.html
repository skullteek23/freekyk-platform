<mat-toolbar
  color="primary"
  class="mat-elevation-z4"
  fxLayoutAlign="start center"
  fxLayoutGap="16px"
>
  <button mat-icon-button mat-dialog-close (click)="onCloseDialog()">
    <mat-icon class="material-icons-round"> close </mat-icon>
  </button>
  <span class="mat-body-1">Send Join Request to a Freekyk Team</span>
</mat-toolbar>
<div class="container-2">
  <div ngClass.lt-md="dialogData" ngClass.gt-sm="stepdata">
    <mat-vertical-stepper #stepper [linear]="true">
      <mat-step
        label="Send Join Request to Teams"
        [completed]="
          te_sel.selectedOptions.selected.length < 5 &&
          te_sel.selectedOptions.selected.length >= 1 &&
          !error
        "
        [state]="state"
      >
        <div class="content_container" fxLayout="column" fxLayoutGap="16px">
          <app-search-lg
            [isDisabled]="noTeams"
            searchPlaceholder="Search teams by name, location"
            (searchItem)="filterTerm = $event"
          >
          </app-search-lg>
          <mat-hint
            *ngIf="
              te_sel.selectedOptions.selected.length > 5 ||
              te_sel.selectedOptions.selected.length < 1
            "
          >
            You can send join requests to maximum 5 teams
          </mat-hint>
          <mat-selection-list dense color="primary" #te_sel>
            <i *ngIf="noTeams">
              Currently, there are no teams available! Please try again later
            </i>
            <mat-list-option
              [value]="team.captainId"
              *ngFor="
                let team of teamsList$
                  | async
                  | filterList: 'tname,locState,locCity':filterTerm
              "
            >
              <div fxLayoutAlign="space-between center">
                <div fxLayoutAlign="start center" fxLayoutGap="8px">
                  <img
                    matListAvatar
                    [src]="team.imgpath_logo"
                    alt="Team Logo"
                  />
                  <span ngClass.gt-sm="mat-body-1" ngClass.lt-md="mat-caption">
                    {{ team.tname | slice: 0:30 }}
                  </span>
                </div>
                <a
                  target="_blank"
                  [routerLink]="['/t', team.tname]"
                  class="material-icons-round"
                >
                  open_in_new
                </a>
              </div>
            </mat-list-option>
          </mat-selection-list>

          <button
            (click)="onSubmit(te_sel.selectedOptions.selected)"
            [disabled]="
              te_sel.selectedOptions.selected.length > 5 ||
              te_sel.selectedOptions.selected.length < 1 ||
              error
            "
            class="primaryButton buttonText"
          >
            Next
          </button>
          <p class="mat-caption left">
            By tapping “Next” above, you acknowledge that you have read and
            understood, and agree to
            <a [routerLink]="['/terms']">Freekyk Team Rules & Regulations</a>.
          </p>
        </div>
      </mat-step>
      <mat-step label="Done">
        <div
          class="fin_cont"
          fxLayout="column"
          fxLayoutGap="16px"
          *ngIf="isStepOneComplete"
        >
          <ng-template #spinner>
            <app-loading></app-loading>
          </ng-template>
          <app-tick-animation
            *ngIf="success; else spinner"
          ></app-tick-animation>
          <p class="mat-body-2 center">All Done!</p>
          <p class="mat-body-1 center">
            Captains can now accept your request and send you back a team join
            invite
          </p>
          <p class="mat-caption center">
            (Manage your recieved invites via
            <a (click)="onCloseDialog()" [routerLink]="['/dashboard', 'home']">
              Dashboard
            </a>
            )
          </p>

          <div fxLayoutAlign.gt-sm="center center" fxLayout.lt-md="column">
            <button (click)="onCloseDialog()" class="primaryButton buttonText">
              Finish
            </button>
          </div>
        </div>
      </mat-step>

      <!-- overriding icons -->
      <ng-template matStepperIcon="requests">
        <mat-icon class="material-icons-round"> send </mat-icon>
      </ng-template>

      <ng-template matStepperIcon="complete">
        <mat-icon class="material-icons-round"> check_circle </mat-icon>
      </ng-template>
    </mat-vertical-stepper>
  </div>
</div>
